{% extends 'base.html' %}
{% block content %}
<div style="max-width:600px;margin:2em auto;padding:2em;background:#222;border-radius:12px;box-shadow:0 4px 16px rgba(0,0,0,0.2);">
  <h2 style="margin-bottom:1em;">購入手続き</h2>
    {% if success %}
            <p>ご注文ありがとうございました！</p>
            <p>お名前: {{ name }}</p>
            <p>住所: {{ address }}</p>
            <p>電話番号: {{ phone }}</p>
            <p>ご購入商品:</p>
            <ul>
            {% for item in items %}
                    <li>{{ item.name }} (¥{{ "{:,}".format(item.price) }})</li>
            {% endfor %}
            </ul>
            <p>合計: <strong>¥{{ "{:,}".format(total) }}</strong></p>
    {% else %}
            {% if users and users|length > 0 %}
                                <form method="post" style="margin-bottom:1.5em;">
                                        <label style="font-weight:bold;margin-bottom:0.5em;display:block;">登録済みユーザーから選択：</label>
                                        <select name="select_user" style="width:100%;padding:0.6em;border-radius:6px;border:none;background:#333;color:#fff;font-size:1em;margin-bottom:1em;box-shadow:0 2px 8px rgba(0,0,0,0.08);">
                                                {% for user in users %}
                                                        <option value="{{ loop.index0 }}">{{ user.name }} / {{ user.address }} / {{ user.phone }}</option>
                                                {% endfor %}
                                        </select>
                                        <button type="submit" style="background:#ff9800;color:#222;padding:0.7em 1.5em;border-radius:6px;font-weight:bold;border:none;cursor:pointer;transition:background 0.2s;">このユーザーで購入</button>
                                </form>
            <hr style="margin:2em 0;">
            {% endif %}
            <form method="post" class="checkout-form" style="margin-bottom:1.5em;">
                    <label>新しいユーザー情報で購入:</label><br>
                    <label>お名前:<input type="text" name="name" required></label><br>
                    <label>住所:<input type="text" name="address" required></label><br>
                    <label>電話番号:<input type="text" name="phone" required></label><br>
                    <button type="submit">購入する</button>
            </form>
            <h3>ご購入商品</h3>
            <ul>
            {% for item in items %}
                    <li>{{ item.name }} (¥{{ "{:,}".format(item.price) }})</li>
            {% endfor %}
            </ul>
            <p>合計: <strong>¥{{ "{:,}".format(total) }}</strong></p>
    {% endif %}
</div>
{% endblock %}
